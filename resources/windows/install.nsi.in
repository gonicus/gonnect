# Application details

WriteRegStr SHCTX "SOFTWARE\@APPLICATION_VENDOR@" "" ""
WriteRegStr SHCTX "SOFTWARE\@APPLICATION_VENDOR@\@APPLICATION_NAME@" "" ""
WriteRegStr SHCTX "SOFTWARE\@APPLICATION_VENDOR@\@APPLICATION_NAME@\Capabilities" "ApplicationDescription" "@APPLICATION_DESCRIPTION@"
WriteRegStr SHCTX "SOFTWARE\@APPLICATION_VENDOR@\@APPLICATION_NAME@\Capabilities" "ApplicationName" "@APPLICATION_NAME@"
WriteRegStr SHCTX "SOFTWARE\@APPLICATION_VENDOR@\@APPLICATION_NAME@\Capabilities" "FriendlyAppName" "@APPLICATION_NAME@"
WriteRegStr SHCTX "SOFTWARE\RegisteredApplications" "@APPLICATION_NAME@" "SOFTWARE\@APPLICATION_VENDOR@\@APPLICATION_NAME@\Capabilities"
# name for the list entry in e.g. "open with" list
WriteRegStr HKCU "Software\Classes\Local Settings\Software\Microsoft\Windows\Shell\MuiCache" "$INSTDIR\bin\@APPLICATION_EXECUTABLE@.exe.FriendlyAppName" "@APPLICATION_NAME@"

!macro registerForProtocol _name
    WriteRegStr HKCR "${_name}" "" "URL:${_name}"
    WriteRegStr HKCR "${_name}" "URL Protocol" ""

    WriteRegStr HKCR "@APPLICATION_NAME@.${_name}" "" "@APPLICATION_NAME@ ${_name} Protocol"
    WriteRegStr HKCR "@APPLICATION_NAME@.${_name}\Shell" "" ""
    WriteRegStr HKCR "@APPLICATION_NAME@.${_name}\Shell\Open" "" ""
    WriteRegStr HKCR "@APPLICATION_NAME@.${_name}\Shell\Open\Command" "" "$INSTDIR\bin\@APPLICATION_EXECUTABLE@.exe $\"%1$\""
    WriteRegStr SHCTX "SOFTWARE\@APPLICATION_VENDOR@\@APPLICATION_NAME@\Capabilities\URLAssociations" "${_name}" "@APPLICATION_NAME@.${_name}"
!macroend

# PROTOCOL registration
!insertmacro registerForProtocol "sip"
!insertmacro registerForProtocol "sips"
!insertmacro registerForProtocol "tel"
!insertmacro registerForProtocol "callto"